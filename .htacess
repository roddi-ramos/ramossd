# =========================================
# üöÄ OTIMIZA√á√ÉO + SEGURAN√áA | RODDI RAMOS
# =========================================

# --- SEGURAN√áA B√ÅSICA ---
<IfModule mod_headers.c>
    # For√ßa HTTPS por 2 anos
    Header always set Strict-Transport-Security "max-age=63072000; includeSubDomains; preload"

    # Impede iframes e clickjacking
    Header always set X-Frame-Options "DENY"

    # Previne execu√ß√£o de arquivos com MIME errado
    Header always set X-Content-Type-Options "nosniff"

    # Protege contra vazamento de refer√™ncias
    Header always set Referrer-Policy "strict-origin-when-cross-origin"

    # Isolamento de contexto contra ataques cross-origin
    Header always set Cross-Origin-Opener-Policy "same-origin"
    Header always set Cross-Origin-Embedder-Policy "require-corp"

    # Ativa prote√ß√£o contra XSS
    Header always set X-XSS-Protection "1; mode=block"

    # Define pol√≠tica de conte√∫do b√°sica (ajusta conforme usar scripts externos)
    Header always set Content-Security-Policy "default-src 'self' https: data: 'unsafe-inline' 'unsafe-eval'"
</IfModule>

# --- COMPACTA√á√ÉO GZIP ---
<IfModule mod_deflate.c>
    AddOutputFilterByType DEFLATE text/plain
    AddOutputFilterByType DEFLATE text/html
    AddOutputFilterByType DEFLATE text/xml
    AddOutputFilterByType DEFLATE text/css
    AddOutputFilterByType DEFLATE application/xml
    AddOutputFilterByType DEFLATE application/xhtml+xml
    AddOutputFilterByType DEFLATE application/rss+xml
    AddOutputFilterByType DEFLATE application/javascript
    AddOutputFilterByType DEFLATE application/x-javascript
</IfModule>

# --- CACHE DE ARQUIVOS EST√ÅTICOS ---
<IfModule mod_expires.c>
    ExpiresActive On
    # HTML - recarrega sempre
    ExpiresByType text/html "access plus 0 seconds"
    # CSS, JS - 1 m√™s
    ExpiresByType text/css "access plus 1 month"
    ExpiresByType application/javascript "access plus 1 month"
    ExpiresByType application/x-javascript "access plus 1 month"
    # Imagens - 1 ano
    ExpiresByType image/jpeg "access plus 1 year"
    ExpiresByType image/png "access plus 1 year"
    ExpiresByType image/gif "access plus 1 year"
    ExpiresByType image/webp "access plus 1 year"
    ExpiresByType image/svg+xml "access plus 1 year"
    # Fontes - 1 ano
    ExpiresByType font/ttf "access plus 1 year"
    ExpiresByType font/woff "access plus 1 year"
    ExpiresByType font/woff2 "access plus 1 year"
</IfModule>

# --- REDIRECIONAR PARA HTTPS ---
<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteCond %{HTTPS} off
    RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]
</IfModule>

# --- BLOQUEIO DE ARQUIVOS SENS√çVEIS ---
<FilesMatch "(^\.|config\.php|composer\.json|package\.json|README\.md)">
    Require all denied
</FilesMatch>
